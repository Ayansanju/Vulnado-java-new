# Documentation: `Cowsay.java`

## Overview

The `Cowsay` class provides a method to execute the `cowsay` command-line utility, which generates ASCII art of a cow saying a given input message. This class uses Java's `ProcessBuilder` to execute the command in a shell environment and captures the output.

---

## Class: `Cowsay`

### Purpose
The `Cowsay` class is designed to interact with the `cowsay` utility installed on the system. It takes a string input, passes it to the `cowsay` command, and returns the resulting ASCII art as a string.

---

### Method: `run(String input)`

#### Description
The `run` method executes the `cowsay` command with the provided input string and captures the output. It uses a `ProcessBuilder` to invoke the command in a bash shell and reads the output using a `BufferedReader`.

#### Parameters
| Parameter | Type   | Description                          |
|-----------|--------|--------------------------------------|
| `input`   | String | The message to be displayed by `cowsay`. |

#### Return Value
| Type   | Description                                      |
|--------|--------------------------------------------------|
| String | The ASCII art output generated by the `cowsay` command. |

#### Logic Flow
1. Constructs the command string: `/usr/games/cowsay '<input>'`.
2. Configures a `ProcessBuilder` to execute the command in a bash shell.
3. Starts the process and captures the output using a `BufferedReader`.
4. Appends each line of the output to a `StringBuilder`.
5. Returns the final output as a string.

#### Exception Handling
- Catches any `Exception` that occurs during the process execution and prints the stack trace using `e.printStackTrace()`.

---

## Insights

### Security Concerns
- **Command Injection Vulnerability**: The method directly concatenates the user-provided `input` into the command string without sanitization. This makes the application vulnerable to command injection attacks. For example, an attacker could pass malicious input like `"; rm -rf /;"` to execute arbitrary commands on the system.
- **Mitigation**: Use parameterized commands or sanitize the input to prevent injection attacks.

### Dependencies
- The `cowsay` utility must be installed on the system at `/usr/games/cowsay` for this class to function correctly. If the utility is not installed or located elsewhere, the method will fail.

### Usability
- The method assumes a Unix-like environment with bash available. It will not work on systems without bash or the `cowsay` utility.

### Error Handling
- The method does not provide robust error handling. It only prints the stack trace in case of an exception, which may not be suitable for production environments. Consider logging errors or returning meaningful error messages.

### Output Formatting
- The method appends a newline character (`\n`) after each line of the output. This ensures the ASCII art is formatted correctly when returned.

---

## Example Usage

```java
public class Main {
  public static void main(String[] args) {
    String message = "Hello, world!";
    String result = Cowsay.run(message);
    System.out.println(result);
  }
}
```

### Expected Output
If the `cowsay` utility is installed and the input is `"Hello, world!"`, the output might look like:

```
 _______________
< Hello, world! >
 ---------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
```

---

## Metadata

| Key         | Value         |
|-------------|---------------|
| File Name   | `Cowsay.java` |
| Package     | `com.scalesec.vulnado` |
